INFO: found LLVMFuzzerCustomMutator (0xaaaadc16f2ec). Disabling -len_control by default.
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 205983623
INFO: Loaded 1 modules   (903 inline 8-bit counters): 903 [0xaaaadc1d22e0, 0xaaaadc1d2667),
INFO: Loaded 1 PC tables (903 PCs): 903 [0xaaaadc1d2668,0xaaaadc1d5ed8),
./fuzzer_store_png_palette: Running 1 inputs 1 time(s) each.
Running: reports/04/poc.bin
=================================================================
==33807==ERROR: AddressSanitizer: attempting free on address which was not malloc()-ed: 0xffffd44e5cf0 in thread T0
    #0 0xaaaadc138174 in __interceptor_free (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0xd8174) (BuildId: 4937edf2aa9994386d89527357b476e96218373a)
    #1 0xaaaadc182f44 in store_idat_plte /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:1124:5
    #2 0xaaaadc1848b4 in store_png_palette /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:1167:3
    #3 0xaaaadc1848b4 in store_png /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:1192:5
    #4 0xaaaadc1762b4 in LLVMFuzzerTestOneInput /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette.cc:30:5
    #5 0xaaaadc0a9284 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x49284) (BuildId: 4937edf2aa9994386d89527357b476e96218373a)
    #6 0xaaaadc0947b8 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x347b8) (BuildId: 4937edf2aa9994386d89527357b476e96218373a)
    #7 0xaaaadc099d34 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x39d34) (BuildId: 4937edf2aa9994386d89527357b476e96218373a)
    #8 0xaaaadc0c132c in main (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x6132c) (BuildId: 4937edf2aa9994386d89527357b476e96218373a)
    #9 0xffffa8d273f8 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #10 0xffffa8d274c8 in __libc_start_main csu/../csu/libc-start.c:392:3
    #11 0xaaaadc09026c in _start (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x3026c) (BuildId: 4937edf2aa9994386d89527357b476e96218373a)

Address 0xffffd44e5cf0 is located in stack of thread T0 at offset 336 in frame
    #0 0xaaaadc182a94 in store_idat_plte /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:1089

  This frame has 2 object(s):
    [32, 40) 'compressed_data_buf'
    [64, 84) 'idat' <== Memory access at offset 336 overflows this variable
HINT: this may be a false positive if your program uses some custom stack unwind mechanism, swapcontext or vfork
      (longjmp and C++ exceptions *are* supported)
SUMMARY: AddressSanitizer: bad-free (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0xd8174) (BuildId: 4937edf2aa9994386d89527357b476e96218373a) in __interceptor_free
==33807==ABORTING