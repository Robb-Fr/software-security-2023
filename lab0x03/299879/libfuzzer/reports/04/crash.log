INFO: found LLVMFuzzerCustomMutator (0xaaaac2b4f22c). Disabling -len_control by default.
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 301232009
INFO: Loaded 1 modules   (895 inline 8-bit counters): 895 [0xaaaac2bb22e0, 0xaaaac2bb265f),
INFO: Loaded 1 PC tables (895 PCs): 895 [0xaaaac2bb2660,0xaaaac2bb5e50),
./fuzzer_store_png_palette: Running 1 inputs 1 time(s) each.
Running: reports/04/poc.bin

=================================================================
==34284==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 10100 byte(s) in 1 object(s) allocated from:
    #0 0xaaaac2b18348 in malloc (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0xd8348) (BuildId: aad28262bc69bda3d9bc9425ea6c2e50688b1039)
    #1 0xaaaac2b62af0 in store_idat_plte /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:1091:33
    #2 0xaaaac2b6468c in store_png_palette /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:1167:3
    #3 0xaaaac2b6468c in store_png /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:1192:5
    #4 0xaaaac2b561f4 in LLVMFuzzerTestOneInput /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette.cc:30:5
    #5 0xaaaac2a891c4 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x491c4) (BuildId: aad28262bc69bda3d9bc9425ea6c2e50688b1039)
    #6 0xaaaac2a746f8 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x346f8) (BuildId: aad28262bc69bda3d9bc9425ea6c2e50688b1039)
    #7 0xaaaac2a79c74 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x39c74) (BuildId: aad28262bc69bda3d9bc9425ea6c2e50688b1039)
    #8 0xaaaac2aa126c in main (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x6126c) (BuildId: aad28262bc69bda3d9bc9425ea6c2e50688b1039)
    #9 0xffff96bb73f8 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #10 0xffff96bb74c8 in __libc_start_main csu/../csu/libc-start.c:392:3
    #11 0xaaaac2a701ac in _start (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x301ac) (BuildId: aad28262bc69bda3d9bc9425ea6c2e50688b1039)

SUMMARY: AddressSanitizer: 10100 byte(s) leaked in 1 allocation(s).

INFO: a leak has been found in the initial corpus.

INFO: to ignore leaks on libFuzzer side use -detect_leaks=0.
