INFO: found LLVMFuzzerCustomMutator (0xaaaab928edac). Disabling -len_control by default.
INFO: Running with entropic power schedule (0xFF, 100).
INFO: Seed: 1826792008
INFO: Loaded 1 modules   (900 inline 8-bit counters): 900 [0xaaaab92f1020, 0xaaaab92f13a4), 
INFO: Loaded 1 PC tables (900 PCs): 900 [0xaaaab92f13a8,0xaaaab92f4be8), 
INFO:      257 files found in seeds/
INFO: -max_len is not provided; libFuzzer will not generate inputs larger than 4096 bytes
INFO: seed corpus: files: 257 min: 1b max: 3680b total: 83711b rss: 39Mb
#258    INITED cov: 133 ft: 205 corp: 51/7496b exec/s: 0 rss: 58Mb
=================================================================
==34873==ERROR: AddressSanitizer: heap-buffer-overflow on address 0xffff86000c73 at pc 0xaaaab929d958 bp 0xffffe8f82c30 sp 0xffffe8f82c28
READ of size 1 at 0xffff86000c73 thread T0
    #0 0xaaaab929d954 in convert_color_palette_to_image /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:436:72
    #1 0xaaaab929f250 in load_png /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:760:10
    #2 0xaaaab9295aec in LLVMFuzzerTestOneInput /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette.cc:21:7
    #3 0xaaaab91c8d44 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x48d44) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #4 0xaaaab91c8558 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x48558) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #5 0xaaaab91c9c34 in fuzzer::Fuzzer::MutateAndTestOne() (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x49c34) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #6 0xaaaab91ca894 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile> >&) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x4a894) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #7 0xaaaab91b98f4 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x398f4) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #8 0xaaaab91e0dec in main (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x60dec) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #9 0xffff8d7873f8 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #10 0xffff8d7874c8 in __libc_start_main csu/../csu/libc-start.c:392:3
    #11 0xaaaab91afd2c in _start (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x2fd2c) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)

0xffff86000c73 is located 0 bytes to the right of 3-byte region [0xffff86000c70,0xffff86000c73)
allocated by thread T0 here:
    #0 0xaaaab9257ec8 in malloc (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0xd7ec8) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #1 0xaaaab929c568 in read_png_chunk /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:254:25
    #2 0xaaaab929eee4 in load_png /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:621:11
    #3 0xaaaab9295aec in LLVMFuzzerTestOneInput /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette.cc:21:7
    #4 0xaaaab91c8d44 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x48d44) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #5 0xaaaab91c8558 in fuzzer::Fuzzer::RunOne(unsigned char const*, unsigned long, bool, fuzzer::InputInfo*, bool, bool*) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x48558) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #6 0xaaaab91c9c34 in fuzzer::Fuzzer::MutateAndTestOne() (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x49c34) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #7 0xaaaab91ca894 in fuzzer::Fuzzer::Loop(std::vector<fuzzer::SizedFile, std::allocator<fuzzer::SizedFile> >&) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x4a894) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #8 0xaaaab91b98f4 in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x398f4) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #9 0xaaaab91e0dec in main (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x60dec) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)
    #10 0xffff8d7873f8 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #11 0xffff8d7874c8 in __libc_start_main csu/../csu/libc-start.c:392:3
    #12 0xaaaab91afd2c in _start (/home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/fuzzer_store_png_palette+0x2fd2c) (BuildId: d17c17276435c64c31ffc723d8454b05264faaa6)

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/robb/Desktop/software-security-2023/lab0x03/libfuzzer/pngparser.c:436:72 in convert_color_palette_to_image
Shadow bytes around the buggy address:
  0x200ff0c00130: fa fa fa fa fa fa fa fa fa fa 04 fa fa fa fa fa
  0x200ff0c00140: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x200ff0c00150: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x200ff0c00160: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x200ff0c00170: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x200ff0c00180: fa fa fa fa fa fa fd fd fa fa fd fd fa fa[03]fa
  0x200ff0c00190: fa fa fa fa fa fa 00 00 fa fa fd fa fa fa fd fa
  0x200ff0c001a0: fa fa fd fa fa fa 00 05 fa fa fd fd fa fa fd fa
  0x200ff0c001b0: fa fa fd fd fa fa fd fa fa fa fd fa fa fa fd fd
  0x200ff0c001c0: fa fa fd fd fa fa fd fa fa fa fd fd fa fa fd fa
  0x200ff0c001d0: fa fa 04 fa fa fa fa fa fa fa 04 fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==34873==ABORTING
MS: 1 CustomCrossOver-; base unit: 9b6bd5889d0ab2d20fd5a526da9058d28ef5bd5c
artifact_prefix='./'; Test unit written to ./crash-0f512463bc7ac8e42f282961e7f20d5fad5e2c0c